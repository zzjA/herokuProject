webpackJsonp([3],{"65MJ":function(e,t){},gmI0:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i("dcGq"),s=i("Au9i"),a={data:function(){return{imgList:[],file:"",fileList:[],imgurl:"",img64:""}},created:function(){},methods:{addImgH:function(e){var t=document.getElementById("upload"),i={},n=t.files[0].name,s=t.files[0].size,a=t.files[0].type,o=this.getObjectURL(t.files[0]);i.name=n,i.size=s,i.type=a,i.src=o,this.imgList.push(i),this.file=t.files[0],console.log(t.files),t.value="",this.compression()},addImg:function(){document.getElementById("upload").click()},upload:function(e){var t=this;console.log(this.file);var i=e;Object(n.h)(i).then(function(e){console.log(e),t.fileList.push(e),t.imgurl=e.file_path,t.$emit("getfilelist",t.fileList),console.log(t.fileList)}).catch(function(e){Object(s.Toast)({message:e,position:"bottom",duration:5e3}),t.imgList.splice(-1,1)})},del:function(e){this.imgList.splice(parseInt(e),1),this.fileList.splice(parseInt(e),1),console.log(this.fileList)},getObjectURL:function(e){var t=null;return void 0!=window.createObjectURL?t=window.createObjectURL(e):void 0!=window.URL?t=window.URL.createObjectURL(e):void 0!=window.webkitURL&&(t=window.webkitURL.createObjectURL(e)),t},compress:function(e,t,i,n){var s;return(s=document.createElement("canvas")).width=t,s.height=i,s.getContext("2d").drawImage(e,0,0,t,i),s.toDataURL("image/jpeg",n)},compression:function(){document.getElementById("main");var e=new Image,t=this.imgList.length;e.src=this.imgList[t-1].src,e.setAttribute("crossOrigin","Anonymous");var i=this;e.onload=function(){var t=this.height,n=this.width,s=i.compress(e,n,t,.3);i.img64=s,console.log(i.showSize(s));for(var a=window.atob(s.split(",")[1]),o=[],l=0;l<a.length;l++)o.push(a.charCodeAt(l));var c=new Blob([new Uint8Array(o)],{type:"image/jpeg"}),r=new FormData;r.append("file",c,Date.now()+".jpg"),i.upload(r)}},showSize:function(e){var t=e.replace("data:image/jpeg;base64,",""),i=t.indexOf("=");t.indexOf("=")>0&&(t=t.substring(0,i));var n=t.length,s=parseInt(n-n/8*2);console.log(s);var a;return a=(s/1048576).toFixed(2),console.log(a),parseFloat(a)},show:function(e){}}},o={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"upload",attrs:{id:"main"}},[0!=e.fileList.length?i("ul",{directives:[{name:"viewer",rawName:"v-viewer",value:{movable:!1},expression:"{movable: false}"}],staticClass:"imgList",attrs:{images:e.imgList}},e._l(e.imgList,function(t,n){return i("li",{key:n},[i("div",{staticClass:"del",on:{click:function(t){e.del(n)}}}),e._v(" "),i("img",{staticClass:"images",attrs:{src:t.src,alt:"",title:t.name+","+n},on:{click:function(t){e.show(n)}}})])})):e._e(),e._v(" "),i("input",{ref:"avatarInput",attrs:{type:"file",id:"upload",accept:"image/png,image/gif,image/jpeg"},on:{change:function(t){e.addImgH()}}}),e._v(" "),i("mt-button",{attrs:{type:"primary"},on:{click:e.addImg}},[e._v("上传图片")])],1)},staticRenderFns:[]};var l=i("VU/8")(a,o,!1,function(e){i("65MJ"),i("m8ED")},"data-v-0537f8a8",null);t.default=l.exports},m8ED:function(e,t){}});
//# sourceMappingURL=3.fcf20447eec6d90133fa.js.map