webpackJsonp([1],{"162o":function(e,t,n){(function(e){var s=void 0!==e&&e||"undefined"!=typeof self&&self||window,i=Function.prototype.apply;function a(e,t){this._id=e,this._clearFn=t}t.setTimeout=function(){return new a(i.call(setTimeout,s,arguments),clearTimeout)},t.setInterval=function(){return new a(i.call(setInterval,s,arguments),clearInterval)},t.clearTimeout=t.clearInterval=function(e){e&&e.close()},a.prototype.unref=a.prototype.ref=function(){},a.prototype.close=function(){this._clearFn.call(s,this._id)},t.enroll=function(e,t){clearTimeout(e._idleTimeoutId),e._idleTimeout=t},t.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},t._unrefActive=t.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;t>=0&&(e._idleTimeoutId=setTimeout(function(){e._onTimeout&&e._onTimeout()},t))},n("mypn"),t.setImmediate="undefined"!=typeof self&&self.setImmediate||void 0!==e&&e.setImmediate||this&&this.setImmediate,t.clearImmediate="undefined"!=typeof self&&self.clearImmediate||void 0!==e&&e.clearImmediate||this&&this.clearImmediate}).call(t,n("DuR2"))},RWsY:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=n("Xxa5"),i=n.n(s),a=n("exGp"),o=n.n(a),r=n("Au9i"),c=n("dcGq"),l=n("162o"),m={data:function(){return{newsListData:[],hasHistory:!1,loading:!0,noMore:!1,isLoading:!1,details:"",responseList:[],picList:[],answerComment:"",responseID:"",commentValue:{page:1,count:20,qmsj_respondent_id:""}}},mounted:function(){var e=this;Object(l.setTimeout)(function(){e.$previewRefresh()},2e3),this.$preview.on("imageLoadComplete",function(e,t){})},methods:{getReadRespondentDetails:function(){var e=this;return o()(i.a.mark(function t(){var n;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(c.e)({qmsj_respondent_id:e.responseID});case 2:n=t.sent,e.details=n.qmsj_respondent_info,e.responseList=n.qmsj_respondent_info.qmsj_respondent_module_list,e.picList=n.qmsj_respondent_info.qmsj_respondent_attachment_list;case 6:case"end":return t.stop()}},t,e)}))()},getCommentList:function(){var e=this;return o()(i.a.mark(function t(){var n,s,a;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e.commentValue.qmsj_respondent_id=e.responseID,t.next=3,Object(c.d)(e.commentValue);case 3:if(n=t.sent,s=n.qmsj_respondent_comment_list.length,e.isLoading=!1,0==s&&0==e.newsListData.length)e.loading=!0,e.hasHistory=!0;else{if(e.hasHistory=!1,s===parseInt(e.commentValue.count)){for(a=0;a<e.commentValue.count;a++)e.newsListData.push(n.qmsj_respondent_comment_list[a]);e.loading=!1}else for(e.loading=!0,e.noMore=!0,a=0;a<s;a++)e.newsListData.push(n.qmsj_respondent_comment_list[a]);0==s&&(e.loading=!0,e.noMore=!0)}case 7:case"end":return t.stop()}},t,e)}))()},loadMore:function(){this.commentValue.page++,this.loading=!0,this.isLoading=!0,this.getCommentList()},submitComment:function(){var e=this;return o()(i.a.mark(function t(){var n;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if((n={}).qmsj_respondent_id=e.responseID,n.comment=e.answerComment,""!=e.answerComment){t.next=6;break}return Object(r.Toast)("请填写评论后提交"),t.abrupt("return");case 6:return t.next=8,Object(c.i)(n);case 8:t.sent,Object(r.Toast)("提交成功"),e.answerComment="",e.newsListData=[],e.commentValue.page=1,e.getCommentList();case 14:case"end":return t.stop()}},t,e)}))()},blurComment:function(){window.scroll(0,0)}},watch:{$route:{immediate:!0,handler:function(){this.responseID=this.$route.params.id,this.getReadRespondentDetails(),this.getCommentList()}}}},u={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"askdetails"},[n("div",{staticClass:"d-main"},[e._l(e.responseList,function(t,s){return n("div",{key:s},e._l(t.qmsj_question_list,function(t,s){return t.format_answer.length>0?n("div",{key:s,staticClass:"d-main-list"},[n("div",{staticClass:"title"},[e._v(e._s(t.question_name))]),e._v(" "),n("div",{staticClass:"answer"},[e._v(e._s(t.format_answer.join(",")))])]):e._e()}))}),e._v(" "),n("div",{staticClass:"pic clear"},[n("ul",e._l(e.picList,function(e,t){return n("li",{key:t},[n("img",{attrs:{src:e.attachment,preview:"1"}})])}))]),e._v(" "),n("div",{staticClass:"comment"},[n("div",{directives:[{name:"infinite-scroll",rawName:"v-infinite-scroll",value:e.loadMore,expression:"loadMore"}],attrs:{"infinite-scroll-disabled":"loading","infinite-scroll-immediate-check":!0,"infinite-scroll-distance":"10"}},e._l(e.newsListData,function(t,s){return n("div",{key:s,staticClass:"com-user"},[n("div",{staticClass:"u-top"},[n("div",{staticClass:"name"},[e._v(e._s(t.qmsj_people_name))]),e._v(" "),n("div",{staticClass:"time"},[e._v(e._s(t.format_add_time))])]),e._v(" "),n("div",{staticClass:"u-main"},[e._v(e._s(t.comment))])])}))]),e._v(" "),e.isLoading?n("div",{staticClass:"loading"},[n("div",{staticClass:"lcing"},[n("mt-spinner",{staticClass:"cir",attrs:{type:"fading-circle",size:30}}),e._v(" 加载中\r\n      ")],1)]):e._e()],2),e._v(" "),e.details.can_comment?n("div",{staticClass:"commentarea"},[n("div",{staticClass:"pltext"},[n("input",{directives:[{name:"model",rawName:"v-model",value:e.answerComment,expression:"answerComment"}],staticClass:"wftext",attrs:{type:"text",placeholder:"请输入您的评论"},domProps:{value:e.answerComment},on:{blur:e.blurComment,input:function(t){t.target.composing||(e.answerComment=t.target.value)}}})]),e._v(" "),n("div",{staticClass:"plbtn"},[n("mt-button",{attrs:{size:"small",type:"primary"},on:{click:e.submitComment}},[e._v("提交")])],1)]):e._e()])},staticRenderFns:[]};var d=n("VU/8")(m,u,!1,function(e){n("tjOp")},"data-v-3a1c87ce",null);t.default=d.exports},mypn:function(e,t,n){(function(e,t){!function(e,n){"use strict";if(!e.setImmediate){var s,i,a,o,r,c=1,l={},m=!1,u=e.document,d=Object.getPrototypeOf&&Object.getPrototypeOf(e);d=d&&d.setTimeout?d:e,"[object process]"==={}.toString.call(e.process)?s=function(e){t.nextTick(function(){p(e)})}:!function(){if(e.postMessage&&!e.importScripts){var t=!0,n=e.onmessage;return e.onmessage=function(){t=!1},e.postMessage("","*"),e.onmessage=n,t}}()?e.MessageChannel?((a=new MessageChannel).port1.onmessage=function(e){p(e.data)},s=function(e){a.port2.postMessage(e)}):u&&"onreadystatechange"in u.createElement("script")?(i=u.documentElement,s=function(e){var t=u.createElement("script");t.onreadystatechange=function(){p(e),t.onreadystatechange=null,i.removeChild(t),t=null},i.appendChild(t)}):s=function(e){setTimeout(p,0,e)}:(o="setImmediate$"+Math.random()+"$",r=function(t){t.source===e&&"string"==typeof t.data&&0===t.data.indexOf(o)&&p(+t.data.slice(o.length))},e.addEventListener?e.addEventListener("message",r,!1):e.attachEvent("onmessage",r),s=function(t){e.postMessage(o+t,"*")}),d.setImmediate=function(e){"function"!=typeof e&&(e=new Function(""+e));for(var t=new Array(arguments.length-1),n=0;n<t.length;n++)t[n]=arguments[n+1];var i={callback:e,args:t};return l[c]=i,s(c),c++},d.clearImmediate=f}function f(e){delete l[e]}function p(e){if(m)setTimeout(p,0,e);else{var t=l[e];if(t){m=!0;try{!function(e){var t=e.callback,s=e.args;switch(s.length){case 0:t();break;case 1:t(s[0]);break;case 2:t(s[0],s[1]);break;case 3:t(s[0],s[1],s[2]);break;default:t.apply(n,s)}}(t)}finally{f(e),m=!1}}}}}("undefined"==typeof self?void 0===e?this:e:self)}).call(t,n("DuR2"),n("W2nU"))},tjOp:function(e,t){}});
//# sourceMappingURL=1.8123506d319468cd20ea.js.map